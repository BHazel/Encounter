#!/bin/bash

#######################################################################

# JCounterpoise 1.2.0.46 Configuration Script

# This script will generate the necessary Makefile to
# compile JCounterpoise. Edit the settings as necessary in
# this section to customise the compilation process.

# Core commands refer to UNIX(-like) operating systems

# Compilation
# -----------

# Java Compiler, e.g. javac, gcj
JC=javac

# Output directory for JCounterpoise binary (abolsute path recommended)
BINDIR=~/bin

# Compiler flag(s) to control Java output
BINDIR_FLAGS=-d

# Shell Script
# ------------

# Java interpreter
JI=java

# Interpreter flag for JCounterpoise directory
DIRFLAG=-cp

# Output directory for shell script (absolute path recommended)
SHDIR=~/bin

# Shell: Currently only bash

#######################################################################

# DO NOT EDIT BEYOND THIS LINE!

JCP_VERSION=1.2.0.46

echo Generating Makefile...
cat << EOF > Makefile
# JCounterpoise Makefile v1.0.7.26
# Generated by configure script

JC=$JC
SOURCES=JCounterpoise.java Encounter.java
BINDIR_FLAGS=$BINDIR_FLAGS
BINDIR=$BINDIR
JI=$JI
DIRFLAG=$DIRFLAG
SHDIR=$SHDIR

all: jcounterpoise shell
	@echo --- INSTALLATION COMPLETE ---
	@echo Installation of JCounterpoise $JCP_VERSION Complete
	@echo JCounterpoise can be found in \$(BINDIR)
	@echo To use shell script \(jcp\), ensure \$(SHDIR) is added to PATH

jcounterpoise: file-jcounterpoise
	@echo Compilation Complete

shell: file-shell-script
	@echo Shell Script Installation Complete

clean:
	@echo Removing JCounterpoise $JCP_VERSION...
	rm -f \$(BINDIR)/JCounterpoise.class \$(BINDIR)/Encounter.class
	rm -rf \$(BINDIR)/gnu
	rm -f \$(SHDIR)/jcp
	rm -f Makefile
	@echo --- UNINSTALLATION COMPLETE ---
	@echo If the shell script was installed in a dedicated directory, ensure it is removed from PATH

file-jcounterpoise:
	@echo Compiling JCounterpoise $JCP_VERSION...
	\$(JC) \$(SOURCES) \$(BINDIR_FLAGS) \$(BINDIR)
	cp -r gnu/ \$(BINDIR)/gnu

file-shell-script:
	@echo Installing shell script for JCounterpoise $JCP_VERSION...
	chmod 777 jcp
	mv jcp \$(SHDIR)
EOF

echo COMPILATION:
echo Java Compiler: "$JC"
echo Compiler flags to control Java output: "$BINDIR_FLAGS"
echo JCounterpoise binary output directory: "$BINDIR"
echo SHELL SCRIPT:
echo Java Interpreter: "$JI"
echo Java interpreter path flag: "$DIRFLAG"
echo Shell script output directory: "$SHDIR"
echo Generating shell script...

echo -e "#!/bin/bash\n" > jcp
echo -e "if [ \"\$1\" == \"\" ]; then" >> jcp
echo -e "       $JI $DIRFLAG $BINDIR JCounterpoise" >> jcp
echo -e "elif [ \"\$1\" != \"\" -a \"\$2\" == \"-o\" -a \"\$3\" != \"\" ]; then" >> jcp
echo -e "       $JI $DIRFLAG $BINDIR JCounterpoise \`pwd\`/\"\$1\" \"\$2\" \"\$3\"" >> jcp
echo -e "else" >> jcp
echo -e "       $JI $DIRFLAG $BINDIR JCounterpoise \`pwd\`/\"\$1\"" >> jcp
echo -e "fi" >> jcp

echo Now can now run make to install JCounterpoise
